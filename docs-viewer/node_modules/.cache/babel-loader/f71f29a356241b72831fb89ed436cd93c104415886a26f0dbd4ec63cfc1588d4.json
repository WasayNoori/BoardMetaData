{"ast":null,"code":"import _ from \"lodash\";\nimport mondaySdk from \"monday-sdk-js\";\nimport { regexWebUrl } from \"./url-validation\";\nconst monday = mondaySdk();\nconst STORAGE_KEY = \"docs_key\";\nexport const TYPES = {\n  OTHER: \"OTHER\",\n  GOOGLE_DRIVE: \"GOOGLE_DRIVE\",\n  ONEDRIVE: \"ONEDRIVE\",\n  FIGMA: \"FIGMA\"\n};\n\n// Hash code function taken from https://stackoverflow.com/questions/7616461/generate-a-hash-from-string-in-javascript\nconst hashCode = str => {\n  var hash = 0,\n    i,\n    chr;\n  for (i = 0; i < str.length; i++) {\n    chr = str.charCodeAt(i);\n    hash = (hash << 5) - hash + chr;\n    hash |= 0; // Convert to 32bit integer\n  }\n  return hash;\n};\nexport const removeDoc = async docoment => {\n  let docs = await getDocs();\n  _.remove(docs, doc => doc.id === docoment.id);\n  await monday.storage.instance.setItem(STORAGE_KEY, JSON.stringify(docs));\n  return docs;\n};\nexport const getDocs = async filterValue => {\n  const res = await monday.storage.instance.getItem(STORAGE_KEY);\n  const value = res.data.value ? JSON.parse(res.data.value) : [];\n  const filteredValue = filterValue ? value.filter(doc => doc.name.toLowerCase().includes(filterValue.toLowerCase())) : value;\n  return filteredValue;\n};\nexport const addDoc = async (name, url) => {\n  const isValid = isValidUrl(url);\n  if (!isValid) return false;\n  const docs = await getDocs();\n  const id = hashCode(name + url + Date.now());\n  const type = detectDocType(url);\n  docs.push({\n    id,\n    name,\n    url,\n    type\n  });\n  await monday.storage.instance.setItem(STORAGE_KEY, JSON.stringify(docs));\n  return true;\n};\nexport const updateDoc = async (id, name, url) => {\n  const isValid = isValidUrl(url);\n  if (!isValid) return false;\n  const docs = await getDocs();\n  const currDoc = _.find(docs, doc => doc.id === id);\n  const oldName = currDoc.name;\n  const oldUrl = currDoc.url;\n  currDoc.name = name;\n  currDoc.url = url;\n  await monday.storage.instance.setItem(STORAGE_KEY, JSON.stringify(docs));\n  return true;\n};\nexport const detectDocType = url => {\n  if (_.includes(url, \"docs.google.com\")) {\n    return TYPES.GOOGLE_DRIVE;\n  }\n  if (_.includes(url, \"onedrive.live.com\")) {\n    return TYPES.ONEDRIVE;\n  }\n  if (_.includes(url, \"figma.com\")) {\n    return TYPES.FIGMA;\n  }\n  return TYPES.OTHER;\n};\nexport const isValidUrl = url => {\n  return regexWebUrl.test(url);\n};","map":{"version":3,"names":["_","mondaySdk","regexWebUrl","monday","STORAGE_KEY","TYPES","OTHER","GOOGLE_DRIVE","ONEDRIVE","FIGMA","hashCode","str","hash","i","chr","length","charCodeAt","removeDoc","docoment","docs","getDocs","remove","doc","id","storage","instance","setItem","JSON","stringify","filterValue","res","getItem","value","data","parse","filteredValue","filter","name","toLowerCase","includes","addDoc","url","isValid","isValidUrl","Date","now","type","detectDocType","push","updateDoc","currDoc","find","oldName","oldUrl","test"],"sources":["C:/Users/wasay/source/repos/WasayNoori/BoardMetaData/docs-viewer/src/services/docs-service.js"],"sourcesContent":["import _ from \"lodash\";\nimport mondaySdk from \"monday-sdk-js\";\nimport { regexWebUrl } from \"./url-validation\";\n\nconst monday = mondaySdk();\nconst STORAGE_KEY = \"docs_key\";\nexport const TYPES = {\n  OTHER: \"OTHER\",\n  GOOGLE_DRIVE: \"GOOGLE_DRIVE\",\n  ONEDRIVE: \"ONEDRIVE\",\n  FIGMA: \"FIGMA\",\n};\n\n// Hash code function taken from https://stackoverflow.com/questions/7616461/generate-a-hash-from-string-in-javascript\nconst hashCode = (str) => {\n  var hash = 0,\n    i,\n    chr;\n  for (i = 0; i < str.length; i++) {\n    chr = str.charCodeAt(i);\n    hash = (hash << 5) - hash + chr;\n    hash |= 0; // Convert to 32bit integer\n  }\n  return hash;\n};\n\nexport const removeDoc = async (docoment) => {\n  let docs = await getDocs();\n\n  _.remove(docs, (doc) => doc.id === docoment.id);\n\n  await monday.storage.instance.setItem(STORAGE_KEY, JSON.stringify(docs));\n\n  return docs;\n};\n\nexport const getDocs = async (filterValue) => {\n  const res = await monday.storage.instance.getItem(STORAGE_KEY);\n  const value = res.data.value ? JSON.parse(res.data.value) : [];\n  const filteredValue = filterValue\n    ? value.filter((doc) => doc.name.toLowerCase().includes(filterValue.toLowerCase()))\n    : value;\n  return filteredValue;\n};\n\nexport const addDoc = async (name, url) => {\n  const isValid = isValidUrl(url);\n  if (!isValid) return false;\n\n  const docs = await getDocs();\n  const id = hashCode(name + url + Date.now());\n  const type = detectDocType(url);\n  docs.push({ id, name, url, type });\n  await monday.storage.instance.setItem(STORAGE_KEY, JSON.stringify(docs));\n  return true;\n};\n\nexport const updateDoc = async (id, name, url) => {\n  const isValid = isValidUrl(url);\n  if (!isValid) return false;\n\n  const docs = await getDocs();\n  const currDoc = _.find(docs, (doc) => doc.id === id);\n  const oldName = currDoc.name;\n  const oldUrl = currDoc.url;\n\n  currDoc.name = name;\n  currDoc.url = url;\n\n  await monday.storage.instance.setItem(STORAGE_KEY, JSON.stringify(docs));\n\n  return true;\n};\n\nexport const detectDocType = (url) => {\n  if (_.includes(url, \"docs.google.com\")) {\n    return TYPES.GOOGLE_DRIVE;\n  }\n  if (_.includes(url, \"onedrive.live.com\")) {\n    return TYPES.ONEDRIVE;\n  }\n  if (_.includes(url, \"figma.com\")) {\n    return TYPES.FIGMA;\n  }\n  return TYPES.OTHER;\n};\n\nexport const isValidUrl = (url) => {\n  return regexWebUrl.test(url);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}